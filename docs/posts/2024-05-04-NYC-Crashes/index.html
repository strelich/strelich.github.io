<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jack Strelich">
<meta name="dcterms.date" content="2024-05-06">
<meta name="description" content="Exploring a data set of motor vehicle crashes in New York City">

<title>Jack Strelich, Data Scientist - NYC Crash Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jack Strelich, Data Scientist</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">NYC Crash Data</h1>
                  <div>
        <div class="description">
          Exploring a data set of motor vehicle crashes in New York City
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Data Cleaning</div>
                <div class="quarto-category">Data Visualization</div>
                <div class="quarto-category">Mapping</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jack Strelich </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 6, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#exploring-the-data" id="toc-exploring-the-data" class="nav-link" data-scroll-target="#exploring-the-data">Exploring the data</a>
  <ul class="collapse">
  <li><a href="#time-and-date" id="toc-time-and-date" class="nav-link" data-scroll-target="#time-and-date">Time and date</a></li>
  <li><a href="#injuries-and-fatalities" id="toc-injuries-and-fatalities" class="nav-link" data-scroll-target="#injuries-and-fatalities">Injuries and fatalities</a></li>
  <li><a href="#vehicles" id="toc-vehicles" class="nav-link" data-scroll-target="#vehicles">Vehicles</a>
  <ul class="collapse">
  <li><a href="#cleaning" id="toc-cleaning" class="nav-link" data-scroll-target="#cleaning">Cleaning</a></li>
  <li><a href="#exploring" id="toc-exploring" class="nav-link" data-scroll-target="#exploring">Exploring</a></li>
  </ul></li>
  <li><a href="#mapping" id="toc-mapping" class="nav-link" data-scroll-target="#mapping">Mapping</a>
  <ul class="collapse">
  <li><a href="#individual-crashes" id="toc-individual-crashes" class="nav-link" data-scroll-target="#individual-crashes">Individual crashes</a></li>
  <li><a href="#choropleth-map" id="toc-choropleth-map" class="nav-link" data-scroll-target="#choropleth-map">Choropleth map</a></li>
  <li><a href="#heatmap" id="toc-heatmap" class="nav-link" data-scroll-target="#heatmap">Heatmap</a></li>
  <li><a href="#crashes-by-street-and-tract" id="toc-crashes-by-street-and-tract" class="nav-link" data-scroll-target="#crashes-by-street-and-tract">Crashes by street and tract</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#future-directions" id="toc-future-directions" class="nav-link" data-scroll-target="#future-directions">Future Directions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="overview" class="level1">
<h1>Overview</h1>
<p>In this post, I’ll explore a data set of motor vehicle crashes in New York City obtained via <a href="https://catalog.data.gov/dataset/motor-vehicle-collisions-crashes">data.gov</a>. This data set interested me for two reasons. First, it’s quite comprehensive, covering all crashes resulting in injury and/or over $1000 in damage since mid-2012. Second, it’s messy in a way that’s very representative of real-world data (and very hard to replicate with more “shrink-wrapped” data sets).</p>
<p>My goals for this analysis were to perform some basic data cleaning, get some insights from the data, and practice a type of visualization I don’t get to use very often in my day job: the <a href="https://en.wikipedia.org/wiki/Choropleth_map">choropleth map</a>!</p>
<p>To start, we’ll load the packages we need:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Handling dates</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Mapping</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycgeo)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## And starring...</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme for plots</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we’ll read in the data. Because the CSV is so large (~437 Mb), I decided to read it directly via the URL, rather than downloading and reading the file<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Once the data is loaded, we’ll tweak the column names for readability (converting to sentence case and replacing spaces with underscores), read the <code>Crash_date</code> column via <code>lubridate::as_date()</code>, and change the names of the columns containing vehicle type codes to be consistent with other column names. We’ll also filter the data to look only at crashes in 2023, to avoid using too much memory<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load crash data (https://data.cityofnewyork.us/api/views/h9gi-nx95/rows.csv)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>crash_url <span class="ot">&lt;-</span> <span class="st">"https://data.cityofnewyork.us/api/views/h9gi-nx95/rows.csv"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data (takes a minute!)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>crash_dat <span class="ot">&lt;-</span> vroom<span class="sc">::</span><span class="fu">vroom</span>(<span class="at">file =</span> crash_url, <span class="co"># Read from URL</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">guess_max =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">.name_repair =</span> <span class="sc">~</span><span class="fu">str_replace_all</span>(<span class="fu">str_to_sentence</span>(.x), </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">pattern =</span> <span class="st">" "</span>, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">replacement =</span> <span class="st">"_"</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Crash_date=</span> <span class="fu">as_date</span>(Crash_date, <span class="at">format =</span> <span class="st">"%m/%d/%Y"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(Crash_date) <span class="sc">==</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span> <span class="co"># Only 2023 data</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(\(var) <span class="fu">str_replace_all</span>(var, </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">pattern =</span> <span class="st">"Vehicle_type_code"</span>, </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">replacement =</span> <span class="st">"Type_code_vehicle"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2084770 Columns: 29
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (16): Crash_date, Borough, Location, On_street_name, Cross_street_name,...
dbl  (12): Zip_code, Latitude, Longitude, Number_of_persons_injured, Number_...
time  (1): Crash_time

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="exploring-the-data" class="level1">
<h1>Exploring the data</h1>
<p>Each row of the data set represents a single incident (crash), and records the date/time, location (borough, ZIP code, latitude/longitude, street name), deaths/injuries, the type(s) of vehicle(s) involved, and contributing factors for each vehicle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(crash_dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 96,581
Columns: 29
$ Crash_date                    &lt;date&gt; 2023-12-18, 2023-12-18, 2023-11-17, 202…
$ Crash_time                    &lt;time&gt; 03:40:00, 11:10:00, 23:20:00, 07:26:00,…
$ Borough                       &lt;chr&gt; NA, NA, NA, NA, "MANHATTAN", "MANHATTAN"…
$ Zip_code                      &lt;dbl&gt; NA, NA, NA, NA, 10036, 10011, 10472, 104…
$ Latitude                      &lt;dbl&gt; 40.74660, 40.72258, 40.71664, 40.66688, …
$ Longitude                     &lt;dbl&gt; -73.76503, -73.94049, -73.97561, -73.945…
$ Location                      &lt;chr&gt; "(40.7466, -73.76503)", "(40.722576, -73…
$ On_street_name                &lt;chr&gt; "LONG ISLAND EXPRESSWAY", "BROOKLYN QUEE…
$ Cross_street_name             &lt;chr&gt; NA, NA, NA, NA, "WEST 47 STREET", NA, NA…
$ Off_street_name               &lt;chr&gt; NA, NA, NA, NA, NA, "13        WEST 13 S…
$ Number_of_persons_injured     &lt;dbl&gt; 0, 0, 0, 2, 2, 2, 0, 0, 0, 0, 0, 0, 2, 1…
$ Number_of_persons_killed      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ Number_of_pedestrians_injured &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ Number_of_pedestrians_killed  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ Number_of_cyclist_injured     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ Number_of_cyclist_killed      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ Number_of_motorist_injured    &lt;dbl&gt; 0, 0, 0, 2, 2, 2, 0, 0, 0, 0, 0, 0, 2, 1…
$ Number_of_motorist_killed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ Contributing_factor_vehicle_1 &lt;chr&gt; "Pavement Slippery", "Following Too Clos…
$ Contributing_factor_vehicle_2 &lt;chr&gt; NA, "Unspecified", "Unspecified", "Traff…
$ Contributing_factor_vehicle_3 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ Contributing_factor_vehicle_4 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ Contributing_factor_vehicle_5 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ Collision_id                  &lt;dbl&gt; 4688250, 4688384, 4688910, 4688735, 4688…
$ Type_code_vehicle_1           &lt;chr&gt; "Station Wagon/Sport Utility Vehicle", "…
$ Type_code_vehicle_2           &lt;chr&gt; NA, "Carry All", "Sedan", "School bus", …
$ Type_code_vehicle_3           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ Type_code_vehicle_4           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ Type_code_vehicle_5           &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …</code></pre>
</div>
</div>
<section id="time-and-date" class="level2">
<h2 class="anchored" data-anchor-id="time-and-date">Time and date</h2>
<p>First, let’s look at incidents by month:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crash_dat, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">month</span>(Crash_date, <span class="at">label =</span> <span class="cn">TRUE</span>))) <span class="sc">+</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">y =</span> <span class="st">"Incidents"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-incidents-by-date" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-incidents-by-date-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-incidents-by-date-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-incidents-by-date-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Incidents by date
</figcaption>
</figure>
</div>
</div>
</div>
<p>No obvious differences by month/season! Next, let’s consider crash times. Looking at raw crash time data, there seems to be an unusually high number of crashes at exactly midnight (<code>00:00</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(crash_dat, Crash_time,<span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Crash_time"],"name":[1],"type":["time"],"align":["right"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"00:00:00","2":"1616"},{"1":"15:00:00","2":"926"},{"1":"17:00:00","2":"890"},{"1":"16:00:00","2":"857"},{"1":"08:00:00","2":"833"},{"1":"18:00:00","2":"810"},{"1":"14:00:00","2":"796"},{"1":"09:00:00","2":"786"},{"1":"13:00:00","2":"786"},{"1":"12:00:00","2":"765"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In fact, we see almost twice as many crashes reported at midnight as at 5pm! This makes me suspect that in at least some cases a crash time of <code>00:00</code> represents missing data; for the purposes of this graph, we’ll exclude them.</p>
<p>Now to see whether the time that incidents occurred varied by month. To help us compare months, we’ll use a ridgeline plot<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, via <code>ggridges::geom_density_ridges()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>crash_dat <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Crash_time <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Crash_month =</span> <span class="fu">month</span>(Crash_date, <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Crash_time, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span>Crash_month,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill=</span>Crash_month,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">fct_rev</span>(Crash_month))) <span class="sc">+</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  ggridges<span class="sc">::</span><span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">quantiles =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_time</span>(<span class="at">breaks =</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>)<span class="sc">*</span><span class="dv">14400</span>) <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of day"</span>, <span class="at">y =</span> <span class="st">"Month"</span>, </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Vertical lines represent median."</span>) <span class="sc">+</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-incidents-time-month" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-incidents-time-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-incidents-time-month-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-incidents-time-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Incidents by month and time of day
</figcaption>
</figure>
</div>
</div>
</div>
<p>Crashes by time of day look fairly consistent across months; notice that the median of each distribution is around 2pm. Additionally, we can see peaks in the number of incidents between 8-9am and between 5-6pm (representing rush hour, I’m assuming).</p>
</section>
<section id="injuries-and-fatalities" class="level2">
<h2 class="anchored" data-anchor-id="injuries-and-fatalities">Injuries and fatalities</h2>
<p>To explore crash outcomes, we’ll use <code>pivot_longer()</code> to make a data frame with multiple rows per crash, each row representing the number of motorists, cyclists, or pedestrians (<code>Type</code>) who were injured or killed (<code>Outcome</code>) in that crash.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>outcomes_by_crash <span class="ot">&lt;-</span> crash_dat <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Collision_id, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">starts_with</span>(<span class="st">"Crash"</span>), <span class="co"># Keep date and time</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">starts_with</span>(<span class="st">"Number_of_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"Number_of_"</span>), </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_prefix =</span> <span class="st">"Number_of_"</span>, <span class="co"># Clean up col names</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">_"</span>, <span class="co"># Split at underscore</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"Type"</span>,<span class="st">"Outcome"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Crash_month =</span> <span class="fu">month</span>(Crash_date, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Type =</span> <span class="fu">str_to_title</span>(Type),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Outcome =</span> <span class="fu">str_to_title</span>(Outcome))</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Check our work</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(outcomes_by_crash, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Collision_id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Crash_date"],"name":[2],"type":["date"],"align":["right"]},{"label":["Crash_time"],"name":[3],"type":["time"],"align":["right"]},{"label":["Type"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Outcome"],"name":[5],"type":["chr"],"align":["left"]},{"label":["value"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Crash_month"],"name":[7],"type":["ord"],"align":["right"]}],"data":[{"1":"4688250","2":"2023-12-18","3":"03:40:00","4":"Persons","5":"Injured","6":"0","7":"Dec"},{"1":"4688250","2":"2023-12-18","3":"03:40:00","4":"Persons","5":"Killed","6":"0","7":"Dec"},{"1":"4688250","2":"2023-12-18","3":"03:40:00","4":"Pedestrians","5":"Injured","6":"0","7":"Dec"},{"1":"4688250","2":"2023-12-18","3":"03:40:00","4":"Pedestrians","5":"Killed","6":"0","7":"Dec"},{"1":"4688250","2":"2023-12-18","3":"03:40:00","4":"Cyclist","5":"Injured","6":"0","7":"Dec"},{"1":"4688250","2":"2023-12-18","3":"03:40:00","4":"Cyclist","5":"Killed","6":"0","7":"Dec"},{"1":"4688250","2":"2023-12-18","3":"03:40:00","4":"Motorist","5":"Injured","6":"0","7":"Dec"},{"1":"4688250","2":"2023-12-18","3":"03:40:00","4":"Motorist","5":"Killed","6":"0","7":"Dec"},{"1":"4688384","2":"2023-12-18","3":"11:10:00","4":"Persons","5":"Injured","6":"0","7":"Dec"},{"1":"4688384","2":"2023-12-18","3":"11:10:00","4":"Persons","5":"Killed","6":"0","7":"Dec"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now we can plot total injuries/fatalities for motorists, cyclists, and pedestrians by month. Because fatalities are (thankfully) far rarer than injuries, we’ll use the <code>scales = "free_y"</code> argument to <code>facet_wrap()</code> to let the two halves of the plot use different y-axis limits. We’ll also use <code>fct_reorder()</code> to make sure the ordering of categories in the legend matches the ordering of the categories in the graph itself.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>outcomes_by_crash <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Type <span class="sc">!=</span> <span class="st">"Persons"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="fu">fct_reorder</span>(Type, value, sum, <span class="at">.desc =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Crash_month, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> value, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Type,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> Type)) <span class="sc">+</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom=</span><span class="st">"line"</span>, <span class="at">fun =</span> <span class="st">"sum"</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom=</span><span class="st">"point"</span>, <span class="at">fun =</span> <span class="st">"sum"</span>) <span class="sc">+</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Outcome,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">"free_y"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Number of persons"</span>, <span class="at">x=</span> <span class="st">"Month"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-injuries-fatalities-month" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-injuries-fatalities-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-injuries-fatalities-month-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-injuries-fatalities-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Injuries and fatalities by month
</figcaption>
</figure>
</div>
</div>
</div>
<p>Interestingly, injuries and fatalities for motorists seem to be highest in summer, while injuries and fatalities for pedestrians are lower during these months.</p>
</section>
<section id="vehicles" class="level2">
<h2 class="anchored" data-anchor-id="vehicles">Vehicles</h2>
<p>Next, let’s explore the contributing factors and types of vehicles involved.</p>
<section id="cleaning" class="level3">
<h3 class="anchored" data-anchor-id="cleaning">Cleaning</h3>
<p>We’ll restructure the data such that each row represents one <em>vehicle</em>, rather than one incident!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>vehicle_dat <span class="ot">&lt;-</span> crash_dat <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Collision_id, <span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">"Contributing_factor"</span>,<span class="st">"Type_code"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Collision_id, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_vehicle_"</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>,<span class="st">"Vehicle"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Vehicle =</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(Vehicle)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can look at the different vehicle type codes and contributing factors that occur in the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(vehicle_dat, Type_code, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(vehicle_dat, Contributing_factor, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-incidents-by-vehicle-type-factor-raw" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-incidents-by-vehicle-type-factor-raw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Incidents by vehicle type and contributing factor (raw)
</figcaption>
<div aria-describedby="tbl-incidents-by-vehicle-type-factor-raw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Type_code"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Sedan","2":"74552"},{"1":"Station Wagon/Sport Utility Vehicle","2":"57236"},{"1":"Bike","2":"5444"},{"1":"Pick-up Truck","2":"4189"},{"1":"Taxi","2":"3787"},{"1":"Box Truck","2":"3655"},{"1":"Bus","2":"3424"},{"1":"E-Bike","2":"2546"},{"1":"Motorcycle","2":"2019"},{"1":"Moped","2":"1701"},{"1":"E-Scooter","2":"1518"},{"1":"Tractor Truck Diesel","2":"1369"},{"1":"Van","2":"1116"},{"1":"Ambulance","2":"942"},{"1":"Dump","2":"566"},{"1":"PK","2":"425"},{"1":"Garbage or Refuse","2":"392"},{"1":"Flat Bed","2":"363"},{"1":"Convertible","2":"329"},{"1":"Motorscooter","2":"312"},{"1":"Carry All","2":"254"},{"1":"Tow Truck / Wrecker","2":"249"},{"1":"Tractor Truck Gasoline","2":"241"},{"1":"Chassis Cab","2":"161"},{"1":"Motorbike","2":"160"},{"1":"MOPED","2":"128"},{"1":"AMBULANCE","2":"121"},{"1":"Tanker","2":"112"},{"1":"subn","2":"110"},{"1":"LIMO","2":"81"},{"1":"Concrete Mixer","2":"80"},{"1":"Flat Rack","2":"65"},{"1":"3-Door","2":"51"},{"1":"4 dr sedan","2":"47"},{"1":"van","2":"46"},{"1":"Refrigerated Van","2":"43"},{"1":"Armored Truck","2":"40"},{"1":"FIRE TRUCK","2":"39"},{"1":"TRAILER","2":"39"},{"1":"Beverage Truck","2":"37"},{"1":"Pedicab","2":"35"},{"1":"Truck","2":"29"},{"1":"Trailer","2":"28"},{"1":"Multi-Wheeled Vehicle","2":"27"},{"1":"moped","2":"27"},{"1":"UNK","2":"26"},{"1":"FIRETRUCK","2":"24"},{"1":"Open Body","2":"24"},{"1":"Stake or Rack","2":"24"},{"1":"SCOOTER","2":"22"},{"1":"School Bus","2":"21"},{"1":"Unknown","2":"19"},{"1":"Lift Boom","2":"18"},{"1":"Fire Truck","2":"17"},{"1":"Fire truck","2":"17"},{"1":"ambulance","2":"17"},{"1":"Unk","2":"16"},{"1":"UNKNOWN","2":"15"},{"1":"Bulk Agriculture","2":"14"},{"1":"Commercial","2":"13"},{"1":"Tow Truck","2":"13"},{"1":"COMMERCIAL","2":"12"},{"1":"Minibike","2":"12"},{"1":"Scooter","2":"12"},{"1":"TOW TRUCK","2":"12"},{"1":"FDNY AMBUL","2":"11"},{"1":"FDNY FIRE","2":"11"},{"1":"GARBAGE TR","2":"11"},{"1":"PAS","2":"11"},{"1":"SCHOOL BUS","2":"11"},{"1":"AMBU","2":"10"},{"1":"FORKLIFT","2":"10"},{"1":"MTA BUS","2":"10"},{"1":"TRUCK","2":"10"},{"1":"BOX TRUCK","2":"9"},{"1":"Box truck","2":"9"},{"1":"FDNY TRUCK","2":"9"},{"1":"Firetruck","2":"9"},{"1":"pick","2":"9"},{"1":"COM","2":"8"},{"1":"FORK LIFT","2":"8"},{"1":"Minicycle","2":"8"},{"1":"Sanitation","2":"8"},{"1":"bus","2":"8"},{"1":"FDNY","2":"7"},{"1":"Forklift","2":"7"},{"1":"Pickup with mounted Camper","2":"7"},{"1":"STREET SWE","2":"7"},{"1":"ELECTRIC S","2":"6"},{"1":"GAS SCOOTE","2":"6"},{"1":"Lunch Wagon","2":"6"},{"1":"MOTOR SCOO","2":"6"},{"1":"PICK UP","2":"6"},{"1":"PICK UP TR","2":"6"},{"1":"Pallet","2":"6"},{"1":"ROAD SWEEP","2":"6"},{"1":"Snow Plow","2":"6"},{"1":"VAN TRUCK","2":"6"},{"1":"scooter","2":"6"},{"1":"DUMP TRUCK","2":"5"},{"1":"FDNY Ambul","2":"5"},{"1":"FDNY FIRET","2":"5"},{"1":"Motorized Home","2":"5"},{"1":"PICKUP","2":"5"},{"1":"RV","2":"5"},{"1":"SANITATION","2":"5"},{"1":"School bus","2":"5"},{"1":"UTILITY TR","2":"5"},{"1":"mcy","2":"5"},{"1":"trailer","2":"5"},{"1":"unknown","2":"5"},{"1":"DELIVERY T","2":"4"},{"1":"E-SCOOTER","2":"4"},{"1":"FDNY truck","2":"4"},{"1":"MC","2":"4"},{"1":"PASSENGER","2":"4"},{"1":"PICKUP TRU","2":"4"},{"1":"Pick up tr","2":"4"},{"1":"Pickup tru","2":"4"},{"1":"Tractor tr","2":"4"},{"1":"USPS","2":"4"},{"1":"USPS TRUCK","2":"4"},{"1":"Van Camper","2":"4"},{"1":"CRANE","2":"3"},{"1":"DELV","2":"3"},{"1":"Dump truck","2":"3"},{"1":"Excavator","2":"3"},{"1":"Flatbed","2":"3"},{"1":"GAS MOPED","2":"3"},{"1":"GOLF CART","2":"3"},{"1":"Garbage tr","2":"3"},{"1":"Log","2":"3"},{"1":"NYS AMBULA","2":"3"},{"1":"PSD","2":"3"},{"1":"Pickup","2":"3"},{"1":"SPRINTER V","2":"3"},{"1":"STAK","2":"3"},{"1":"Sprinter v","2":"3"},{"1":"Street Swe","2":"3"},{"1":"Street swe","2":"3"},{"1":"Subn","2":"3"},{"1":"Tow truck","2":"3"},{"1":"Tractor","2":"3"},{"1":"UTIL","2":"3"},{"1":"Unknown ve","2":"3"},{"1":"Utility","2":"3"},{"1":"WAGON","2":"3"},{"1":"X COM","2":"3"},{"1":"c1","2":"3"},{"1":"e-bike","2":"3"},{"1":"garbage tr","2":"3"},{"1":"l1","2":"3"},{"1":"school bus","2":"3"},{"1":"taxi","2":"3"},{"1":"tow truck","2":"3"},{"1":"12 PASSENG","2":"2"},{"1":"2 dr sedan","2":"2"},{"1":"AMBULENCE","2":"2"},{"1":"Ambulence","2":"2"},{"1":"C","2":"2"},{"1":"CARGO VAN","2":"2"},{"1":"COMM VAN","2":"2"},{"1":"Chevy","2":"2"},{"1":"DUMP","2":"2"},{"1":"Delivery","2":"2"},{"1":"Delivery t","2":"2"},{"1":"Dump Truck","2":"2"},{"1":"E SCOOTER","2":"2"},{"1":"E-BIKE","2":"2"},{"1":"E-Unicycle","2":"2"},{"1":"E-bike","2":"2"},{"1":"EMS","2":"2"},{"1":"Electric m","2":"2"},{"1":"Electric s","2":"2"},{"1":"FD AMBULAN","2":"2"},{"1":"FDNY Truck","2":"2"},{"1":"FIRE","2":"2"},{"1":"FIRE ENGIN","2":"2"},{"1":"FLAT BED T","2":"2"},{"1":"FOOD CART","2":"2"},{"1":"FORD","2":"2"},{"1":"FREIGHT VA","2":"2"},{"1":"Fork lift","2":"2"},{"1":"Gas Moped","2":"2"},{"1":"Gas Scoote","2":"2"},{"1":"Gas scoote","2":"2"},{"1":"Ladder tru","2":"2"},{"1":"Lift","2":"2"},{"1":"MOTORCYCLE","2":"2"},{"1":"MOTORIZEDS","2":"2"},{"1":"MTA Bus","2":"2"},{"1":"Mail Truck","2":"2"},{"1":"Minivan","2":"2"},{"1":"Motor scoo","2":"2"},{"1":"OMR","2":"2"},{"1":"OMT","2":"2"},{"1":"OTHER","2":"2"},{"1":"Omnibus","2":"2"},{"1":"PASSANGER","2":"2"},{"1":"PEDICAB","2":"2"},{"1":"POWER SHOV","2":"2"},{"1":"Passenger","2":"2"},{"1":"Pick Up Tr","2":"2"},{"1":"Pick up","2":"2"},{"1":"Pick up Tr","2":"2"},{"1":"Pick-Up","2":"2"},{"1":"Power Shov","2":"2"},{"1":"REFG","2":"2"},{"1":"RMP","2":"2"},{"1":"Road sweep","2":"2"},{"1":"SPC","2":"2"},{"1":"SUBURBAN","2":"2"},{"1":"SUV","2":"2"},{"1":"Sprinter V","2":"2"},{"1":"TRACTOR","2":"2"},{"1":"TRANSPORT","2":"2"},{"1":"Tow","2":"2"},{"1":"UPS TRUCK","2":"2"},{"1":"USPS Truck","2":"2"},{"1":"UTILITY","2":"2"},{"1":"UTILITY VE","2":"2"},{"1":"Van Truck","2":"2"},{"1":"WHITE VAN","2":"2"},{"1":"c3","2":"2"},{"1":"f1","2":"2"},{"1":"fdny truck","2":"2"},{"1":"fire truck","2":"2"},{"1":"fork lift","2":"2"},{"1":"mta bus","2":"2"},{"1":"pick up","2":"2"},{"1":"pick up tr","2":"2"},{"1":"skateboard","2":"2"},{"1":"street swe","2":"2"},{"1":"toyot","2":"2"},{"1":"tr","2":"2"},{"1":"truck","2":"2"},{"1":"utility tr","2":"2"},{"1":"utility ve","2":"2"},{"1":"wheelchair","2":"2"},{"1":"13","2":"1"},{"1":"17","2":"1"},{"1":"18 WHEELER","2":"1"},{"1":"2YDSWHEELL","2":"1"},{"1":"4 wheeler","2":"1"},{"1":"4dsd","2":"1"},{"1":"787","2":"1"},{"1":"A","2":"1"},{"1":"A bulance","2":"1"},{"1":"ABMU","2":"1"},{"1":"ACUR","2":"1"},{"1":"AMAZON VAN","2":"1"},{"1":"AMB","2":"1"},{"1":"AMBALANCE","2":"1"},{"1":"AMBLUANCE","2":"1"},{"1":"AMBULANVE","2":"1"},{"1":"AMULANCE","2":"1"},{"1":"Amb","2":"1"},{"1":"Ambu","2":"1"},{"1":"BEYOND SCO","2":"1"},{"1":"BOBCAT","2":"1"},{"1":"BOBCAT/FOR","2":"1"},{"1":"BOOM LIFT","2":"1"},{"1":"BOOM MOPED","2":"1"},{"1":"BOX CAR","2":"1"},{"1":"BOX VAN","2":"1"},{"1":"BOXTRUCK","2":"1"},{"1":"BUS (OMNIB","2":"1"},{"1":"Backhoe","2":"1"},{"1":"Backhoe Lo","2":"1"},{"1":"Boom Lift","2":"1"},{"1":"Box Car","2":"1"},{"1":"Box Mail t","2":"1"},{"1":"Bread truc","2":"1"},{"1":"Bucket tru","2":"1"},{"1":"Bull dozer","2":"1"},{"1":"Bulldozer","2":"1"},{"1":"C1","2":"1"},{"1":"C2","2":"1"},{"1":"C3","2":"1"},{"1":"C40","2":"1"},{"1":"C45 BOC TR","2":"1"},{"1":"CAN","2":"1"},{"1":"CAR/SUV","2":"1"},{"1":"CARAVAN","2":"1"},{"1":"CEMENT MIX","2":"1"},{"1":"CHEVY VAN","2":"1"},{"1":"COMMERICIA","2":"1"},{"1":"CONSTRUCTI","2":"1"},{"1":"Car Traile","2":"1"},{"1":"Cargo van","2":"1"},{"1":"Carrier","2":"1"},{"1":"Com","2":"1"},{"1":"Courier","2":"1"},{"1":"Crane","2":"1"},{"1":"D3","2":"1"},{"1":"DELIVERY","2":"1"},{"1":"DELV WH","2":"1"},{"1":"DIRTBIKE","2":"1"},{"1":"DOT","2":"1"},{"1":"DOT Safety","2":"1"},{"1":"DOT TOW TR","2":"1"},{"1":"DOT TRUCK","2":"1"},{"1":"DOT VEHICL","2":"1"},{"1":"DSNY Garba","2":"1"},{"1":"Department","2":"1"},{"1":"Dodge ram","2":"1"},{"1":"Dumpster t","2":"1"},{"1":"E MOTORCYC","2":"1"},{"1":"E-SKATEBOA","2":"1"},{"1":"E-scooter","2":"1"},{"1":"EBIKE","2":"1"},{"1":"ELECTRIC C","2":"1"},{"1":"ELECTRIC M","2":"1"},{"1":"EMI- TRAIL","2":"1"},{"1":"EMS AMBULA","2":"1"},{"1":"EMT Ambula","2":"1"},{"1":"ESCOOTER","2":"1"},{"1":"EXCABATOR","2":"1"},{"1":"EXCAVATOR","2":"1"},{"1":"Ele. Unicy","2":"1"},{"1":"Electric M","2":"1"},{"1":"Electric S","2":"1"},{"1":"Electrict","2":"1"},{"1":"Electricun","2":"1"},{"1":"Ems truck","2":"1"},{"1":"Enclosed Body - Nonremovable Enclosure","2":"1"},{"1":"Enclosed Body - Removable Enclosure","2":"1"},{"1":"F550","2":"1"},{"1":"FD Pickup","2":"1"},{"1":"FDNY ENGIN","2":"1"},{"1":"FDNY Ferra","2":"1"},{"1":"FDNY Fire","2":"1"},{"1":"FDNY LADDE","2":"1"},{"1":"FDNY SP200","2":"1"},{"1":"FDNY SUPER","2":"1"},{"1":"FDNY UTILI","2":"1"},{"1":"FDNY Vehic","2":"1"},{"1":"FDNY firet","2":"1"},{"1":"FDNY mecha","2":"1"},{"1":"FDNY- Fire","2":"1"},{"1":"FDNY285 En","2":"1"},{"1":"FLAT","2":"1"},{"1":"FLYWING MO","2":"1"},{"1":"FOGLIFT","2":"1"},{"1":"FOOD TRUCK","2":"1"},{"1":"FORD AMBUL","2":"1"},{"1":"FORD F-150","2":"1"},{"1":"FORD SUPER","2":"1"},{"1":"FORD TWO T","2":"1"},{"1":"FORD-TCN","2":"1"},{"1":"FREIGHT LI","2":"1"},{"1":"FREIGHTLIN","2":"1"},{"1":"FRHT VEHIC","2":"1"},{"1":"FRHT-SPR","2":"1"},{"1":"Fdny","2":"1"},{"1":"Fdny 331 k","2":"1"},{"1":"Fdny Fire","2":"1"},{"1":"Fdny fire","2":"1"},{"1":"Fdny truck","2":"1"},{"1":"Fed Ex Van","2":"1"},{"1":"FedEx Truc","2":"1"},{"1":"Fedex truc","2":"1"},{"1":"Fire Engin","2":"1"},{"1":"Fire engin","2":"1"},{"1":"FireTruck","2":"1"},{"1":"Flywing","2":"1"},{"1":"Food Cart","2":"1"},{"1":"Ford","2":"1"},{"1":"Ford Couri","2":"1"},{"1":"Ford FF","2":"1"},{"1":"Ford Trans","2":"1"},{"1":"Ford f150","2":"1"},{"1":"Freight Va","2":"1"},{"1":"G   SCL","2":"1"},{"1":"GAS PWR SC","2":"1"},{"1":"GEICO","2":"1"},{"1":"GOLFCART","2":"1"},{"1":"GOVENMENT","2":"1"},{"1":"GSPC","2":"1"},{"1":"GTH-1056","2":"1"},{"1":"Garbage Tr","2":"1"},{"1":"Golf cart","2":"1"},{"1":"Government","2":"1"},{"1":"Govt P/U T","2":"1"},{"1":"Grumman LL","2":"1"},{"1":"HEAVY TRUC","2":"1"},{"1":"HORSE DRAW","2":"1"},{"1":"HORSE TRAI","2":"1"},{"1":"HOUSE ON W","2":"1"},{"1":"HURSE","2":"1"},{"1":"Hopper","2":"1"},{"1":"Horse Carr","2":"1"},{"1":"I1","2":"1"},{"1":"JEEP","2":"1"},{"1":"JJ150T-4A","2":"1"},{"1":"JLG ULTRA","2":"1"},{"1":"JOHND","2":"1"},{"1":"KME","2":"1"},{"1":"LAWNMOWER","2":"1"},{"1":"LIABITIY","2":"1"},{"1":"LSV","2":"1"},{"1":"LTR","2":"1"},{"1":"Ladder","2":"1"},{"1":"Lim","2":"1"},{"1":"Limo","2":"1"},{"1":"M/C","2":"1"},{"1":"MACK","2":"1"},{"1":"MACK TRUCK","2":"1"},{"1":"MANUAL SCO","2":"1"},{"1":"MARKED RMP","2":"1"},{"1":"MECHANICAL","2":"1"},{"1":"METRO TRAN","2":"1"},{"1":"METROTECH","2":"1"},{"1":"MILITARY","2":"1"},{"1":"MINI VAHN","2":"1"},{"1":"MINI VAN","2":"1"},{"1":"MOOPER","2":"1"},{"1":"MOPD","2":"1"},{"1":"MOPED CLAS","2":"1"},{"1":"MOPED GAS","2":"1"},{"1":"MOPPED","2":"1"},{"1":"MOTO-SCOOT","2":"1"},{"1":"MOTOR. SCO","2":"1"},{"1":"MOTORHOME","2":"1"},{"1":"MOTORIZED","2":"1"},{"1":"MOVING VAN","2":"1"},{"1":"MTA","2":"1"},{"1":"MTA ESU VE","2":"1"},{"1":"MTA TRANSI","2":"1"},{"1":"MTA transi","2":"1"},{"1":"Mack truck","2":"1"},{"1":"ManPower s","2":"1"},{"1":"Mcy","2":"1"},{"1":"Military v","2":"1"},{"1":"Mopad","2":"1"},{"1":"Motor Scoo","2":"1"},{"1":"Motorized","2":"1"},{"1":"Mta bus","2":"1"},{"1":"N/A","2":"1"},{"1":"NE/FL","2":"1"},{"1":"NYC AMBULA","2":"1"},{"1":"NYC FDNY #","2":"1"},{"1":"NYC FIRE T","2":"1"},{"1":"NYC SANITA","2":"1"},{"1":"NYC TRANSI","2":"1"},{"1":"NYCHA FORK","2":"1"},{"1":"NYPD Tow t","2":"1"},{"1":"OMS","2":"1"},{"1":"P PSD","2":"1"},{"1":"P/SH YW","2":"1"},{"1":"P/U","2":"1"},{"1":"PASS VAN","2":"1"},{"1":"PEDAL BIKE","2":"1"},{"1":"PENSKE BOX","2":"1"},{"1":"PICK-UP","2":"1"},{"1":"PKUP","2":"1"},{"1":"POLICE VEH","2":"1"},{"1":"POSTAL tru","2":"1"},{"1":"POSTOFFICE","2":"1"},{"1":"PROGRESSIV","2":"1"},{"1":"Pickup SL","2":"1"},{"1":"Pickup tow","2":"1"},{"1":"Postal Tru","2":"1"},{"1":"Power shov","2":"1"},{"1":"Private Am","2":"1"},{"1":"RAM","2":"1"},{"1":"RAM COMM.","2":"1"},{"1":"REAR END","2":"1"},{"1":"RED","2":"1"},{"1":"REF BOX TR","2":"1"},{"1":"REG","2":"1"},{"1":"REVEL MOPE","2":"1"},{"1":"REVEL SCOO","2":"1"},{"1":"ROLLOFF","2":"1"},{"1":"RV motorho","2":"1"},{"1":"Razor Scoo","2":"1"},{"1":"Rds","2":"1"},{"1":"Ridgeline","2":"1"},{"1":"Rmp","2":"1"},{"1":"Road Sweep","2":"1"},{"1":"SALTSPREAD","2":"1"},{"1":"SCHOOL  BU","2":"1"},{"1":"SCHOOLBUS","2":"1"},{"1":"SCOOTER (G","2":"1"},{"1":"SCOOTER SI","2":"1"},{"1":"SCOOTER/MO","2":"1"},{"1":"SEDAN","2":"1"},{"1":"SELF INSUR","2":"1"},{"1":"SEMI","2":"1"},{"1":"SEMI-TRUCK","2":"1"},{"1":"SEMITRAILE","2":"1"},{"1":"SKATEBOARD","2":"1"},{"1":"SPRINTER","2":"1"},{"1":"STAND UP S","2":"1"},{"1":"STAND UP s","2":"1"},{"1":"STREET CLE","2":"1"},{"1":"Scooter ga","2":"1"},{"1":"Scooter/Mo","2":"1"},{"1":"Seagrave T","2":"1"},{"1":"Siting mop","2":"1"},{"1":"Skateboard","2":"1"},{"1":"Small Bus","2":"1"},{"1":"Spc","2":"1"},{"1":"Sprinter","2":"1"},{"1":"Subn/ambul","2":"1"},{"1":"Suburban","2":"1"},{"1":"TF","2":"1"},{"1":"TL","2":"1"},{"1":"TL TRAILER","2":"1"},{"1":"TOW-TRUCK","2":"1"},{"1":"TRAC","2":"1"},{"1":"TRACTOR TR","2":"1"},{"1":"TRAILER/TR","2":"1"},{"1":"Tank","2":"1"},{"1":"Tank truck","2":"1"},{"1":"Telehandle","2":"1"},{"1":"Tk","2":"1"},{"1":"Tracktor T","2":"1"},{"1":"Tractor Tr","2":"1"},{"1":"Traffic To","2":"1"},{"1":"Trailer Fl","2":"1"},{"1":"Trailor","2":"1"},{"1":"Transit va","2":"1"},{"1":"U HAUL","2":"1"},{"1":"U haul tra","2":"1"},{"1":"UHAUL","2":"1"},{"1":"UHAUL TRAI","2":"1"},{"1":"UHal Renta","2":"1"},{"1":"UKNOWN","2":"1"},{"1":"UNKN","2":"1"},{"1":"UNKNOWN CA","2":"1"},{"1":"UNKOWM","2":"1"},{"1":"UNKOWN","2":"1"},{"1":"UNKWOWN","2":"1"},{"1":"UPS Truck","2":"1"},{"1":"UPS VAN","2":"1"},{"1":"UPS truck","2":"1"},{"1":"US Postal","2":"1"},{"1":"USPS #6530","2":"1"},{"1":"USPS MAIL","2":"1"},{"1":"USPS Post","2":"1"},{"1":"USPS VAN","2":"1"},{"1":"USPS VEHIC","2":"1"},{"1":"Usps truck","2":"1"},{"1":"Utility Ve","2":"1"},{"1":"Utility tr","2":"1"},{"1":"Utility ve","2":"1"},{"1":"VA","2":"1"},{"1":"VAN (TRANS","2":"1"},{"1":"VAn","2":"1"},{"1":"VENDOR FOO","2":"1"},{"1":"VESPA","2":"1"},{"1":"Van (Trans","2":"1"},{"1":"Van truck","2":"1"},{"1":"Van/Truck","2":"1"},{"1":"Vanette","2":"1"},{"1":"WHEELCHAIR","2":"1"},{"1":"WSTR","2":"1"},{"1":"Waste truc","2":"1"},{"1":"Well Driller","2":"1"},{"1":"White Ford","2":"1"},{"1":"White Work","2":"1"},{"1":"Workcart","2":"1"},{"1":"X Amb","2":"1"},{"1":"YELLOW BUS","2":"1"},{"1":"Yale Fork","2":"1"},{"1":"Yellow bus","2":"1"},{"1":"a","2":"1"},{"1":"access-a-r","2":"1"},{"1":"amazon tru","2":"1"},{"1":"ambu","2":"1"},{"1":"black","2":"1"},{"1":"black mope","2":"1"},{"1":"box truck","2":"1"},{"1":"box van","2":"1"},{"1":"camper","2":"1"},{"1":"cart","2":"1"},{"1":"chev","2":"1"},{"1":"com","2":"1"},{"1":"commercial","2":"1"},{"1":"commerial","2":"1"},{"1":"commerical","2":"1"},{"1":"d3","2":"1"},{"1":"del truck","2":"1"},{"1":"delivery t","2":"1"},{"1":"delv","2":"1"},{"1":"derelict v","2":"1"},{"1":"dirt bike","2":"1"},{"1":"e scooter","2":"1"},{"1":"e-scooter","2":"1"},{"1":"electric s","2":"1"},{"1":"ems bus","2":"1"},{"1":"escooter","2":"1"},{"1":"f","2":"1"},{"1":"fdny fire","2":"1"},{"1":"firetruck","2":"1"},{"1":"ford trans","2":"1"},{"1":"forklift","2":"1"},{"1":"gas moped","2":"1"},{"1":"mini bus","2":"1"},{"1":"motor scoo","2":"1"},{"1":"motorcycle","2":"1"},{"1":"nissa","2":"1"},{"1":"pass","2":"1"},{"1":"pickup tow","2":"1"},{"1":"pickup tru","2":"1"},{"1":"police van","2":"1"},{"1":"power shov","2":"1"},{"1":"push scoot","2":"1"},{"1":"refg","2":"1"},{"1":"rgs","2":"1"},{"1":"sprinter v","2":"1"},{"1":"standing s","2":"1"},{"1":"sub","2":"1"},{"1":"subar","2":"1"},{"1":"tow","2":"1"},{"1":"tractor tr","2":"1"},{"1":"u haul","2":"1"},{"1":"usps truck","2":"1"},{"1":"utv bobcat","2":"1"},{"1":"wag","2":"1"},{"1":"wagon","2":"1"},{"1":"work van","2":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Contributing_factor"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Unspecified","2":"85757"},{"1":"Driver Inattention/Distraction","2":"28025"},{"1":"Following Too Closely","2":"7423"},{"1":"Failure to Yield Right-of-Way","2":"6953"},{"1":"Passing or Lane Usage Improper","2":"4984"},{"1":"Unsafe Speed","2":"4325"},{"1":"Other Vehicular","2":"4153"},{"1":"Passing Too Closely","2":"3590"},{"1":"Traffic Control Disregarded","2":"3382"},{"1":"Backing Unsafely","2":"2973"},{"1":"Turning Improperly","2":"2434"},{"1":"Driver Inexperience","2":"2356"},{"1":"Unsafe Lane Changing","2":"2149"},{"1":"Alcohol Involvement","2":"1861"},{"1":"Reaction to Uninvolved Vehicle","2":"1283"},{"1":"Pedestrian/Bicyclist/Other Pedestrian Error/Confusion","2":"1268"},{"1":"View Obstructed/Limited","2":"1010"},{"1":"Aggressive Driving/Road Rage","2":"936"},{"1":"Pavement Slippery","2":"671"},{"1":"Fell Asleep","2":"459"},{"1":"Oversized Vehicle","2":"443"},{"1":"Brakes Defective","2":"396"},{"1":"Passenger Distraction","2":"301"},{"1":"Outside Car Distraction","2":"281"},{"1":"Obstruction/Debris","2":"238"},{"1":"Steering Failure","2":"213"},{"1":"Lost Consciousness","2":"207"},{"1":"Illnes","2":"184"},{"1":"Tire Failure/Inadequate","2":"161"},{"1":"Glare","2":"139"},{"1":"Failure to Keep Right","2":"138"},{"1":"Driverless/Runaway Vehicle","2":"106"},{"1":"Fatigued/Drowsy","2":"93"},{"1":"Pavement Defective","2":"90"},{"1":"Drugs (illegal)","2":"81"},{"1":"Animals Action","2":"79"},{"1":"Accelerator Defective","2":"65"},{"1":"Traffic Control Device Improper/Non-Working","2":"53"},{"1":"Cell Phone (hand-Held)","2":"43"},{"1":"Lane Marking Improper/Inadequate","2":"41"},{"1":"Physical Disability","2":"34"},{"1":"Tinted Windows","2":"26"},{"1":"Prescription Medication","2":"20"},{"1":"Tow Hitch Defective","2":"15"},{"1":"Vehicle Vandalism","2":"15"},{"1":"Headlights Defective","2":"10"},{"1":"Other Electronic Device","2":"10"},{"1":"Other Lighting Defects","2":"9"},{"1":"Eating or Drinking","2":"8"},{"1":"Using On Board Navigation Device","2":"8"},{"1":"Cell Phone (hands-free)","2":"4"},{"1":"Shoulders Defective/Improper","2":"3"},{"1":"Texting","2":"3"},{"1":"Windshield Inadequate","2":"3"},{"1":"Listening/Using Headphones","2":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>There are a <em>lot</em> of categories in here, and many of them appear to overlap (e.g., “Motorcycle” and “Motorbike”). To clean up a bit, we’ll change all <code>Type_code</code> entries to sentence case, then manually consolidate some levels:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>vehicle_dat <span class="ot">&lt;-</span> vehicle_dat <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type_code =</span> <span class="fu">str_to_sentence</span>(Type_code),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Type_code =</span> <span class="fu">case_when</span>( <span class="co"># checks a series of conditionals</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(Type_code, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">coll</span>(<span class="st">"wagon"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"SUV/station wagon"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_detect</span>(Type_code, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">coll</span>(<span class="st">"sedan"</span>,<span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Sedan"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">.default =</span> Type_code),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Type_code =</span> <span class="fu">case_match</span>( <span class="co"># Replaces (vectors of) matches, OLD ~ NEW</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>           Type_code,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Bicycle"</span> <span class="sc">~</span> <span class="st">"Bike"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Motorbike"</span> <span class="sc">~</span> <span class="st">"Motorcycle"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Ambul"</span>,<span class="st">"Ambu"</span>,<span class="st">"Amb"</span>) <span class="sc">~</span> <span class="st">"Ambulance"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Unkno"</span>,<span class="st">"Unk"</span>) <span class="sc">~</span> <span class="st">"Unknown"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"Fire"</span>,<span class="st">"Fdny"</span>,<span class="st">"Firetruck"</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Firet"</span>,<span class="st">"Fdny truck"</span>,<span class="st">"Fdny fire"</span>) <span class="sc">~</span> <span class="st">"Fire truck"</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>           <span class="st">"E-sco"</span> <span class="sc">~</span> <span class="st">"E-scooter"</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>           <span class="st">"E-bik"</span> <span class="sc">~</span> <span class="st">"E-bike"</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">.default =</span> Type_code) <span class="sc">%&gt;%</span> </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>           <span class="fu">fct_lump_prop</span>(<span class="fl">0.005</span>), <span class="co"># Lump codes occurring less than 0.5% </span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">Contributing_factor =</span> <span class="fu">fct_lump_prop</span>(</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>           <span class="fu">str_to_sentence</span>(Contributing_factor), </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>           <span class="fl">0.005</span>)) <span class="co"># same for contributing factor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s check our work:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(crashes_by_type <span class="ot">&lt;-</span> <span class="fu">count</span>(vehicle_dat, Type_code, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">name =</span> <span class="st">"Crashes"</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>(crashes_by_factor <span class="ot">&lt;-</span> <span class="fu">count</span>(vehicle_dat, Contributing_factor, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">name =</span> <span class="st">"Crashes"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-incidents-by-vehicle-type-factor" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-incidents-by-vehicle-type-factor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Incidents by vehicle type and contributing factor
</figcaption>
<div aria-describedby="tbl-incidents-by-vehicle-type-factor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Type_code"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Crashes"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Sedan","2":"74602"},{"1":"SUV/station wagon","2":"57246"},{"1":"Bike","2":"5444"},{"1":"Other","2":"5395"},{"1":"Pick-up truck","2":"4189"},{"1":"Taxi","2":"3790"},{"1":"Box truck","2":"3674"},{"1":"Bus","2":"3432"},{"1":"E-bike","2":"2553"},{"1":"Motorcycle","2":"2182"},{"1":"Moped","2":"1856"},{"1":"E-scooter","2":"1524"},{"1":"Tractor truck diesel","2":"1369"},{"1":"Van","2":"1163"},{"1":"Ambulance","2":"1094"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Contributing_factor"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Crashes"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Unspecified","2":"85757"},{"1":"Driver inattention/distraction","2":"28025"},{"1":"Following too closely","2":"7423"},{"1":"Failure to yield right-of-way","2":"6953"},{"1":"Passing or lane usage improper","2":"4984"},{"1":"Other","2":"4651"},{"1":"Unsafe speed","2":"4325"},{"1":"Other vehicular","2":"4153"},{"1":"Passing too closely","2":"3590"},{"1":"Traffic control disregarded","2":"3382"},{"1":"Backing unsafely","2":"2973"},{"1":"Turning improperly","2":"2434"},{"1":"Driver inexperience","2":"2356"},{"1":"Unsafe lane changing","2":"2149"},{"1":"Alcohol involvement","2":"1861"},{"1":"Reaction to uninvolved vehicle","2":"1283"},{"1":"Pedestrian/bicyclist/other pedestrian error/confusion","2":"1268"},{"1":"View obstructed/limited","2":"1010"},{"1":"Aggressive driving/road rage","2":"936"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>It’s not perfect, and a subject matter expert could probably identify more types/factors that could be combined, but it should be workable for our purposes.</p>
</section>
<section id="exploring" class="level3">
<h3 class="anchored" data-anchor-id="exploring">Exploring</h3>
<section id="what-types-of-vehicles-were-involved-in-crashes" class="level4">
<h4 class="anchored" data-anchor-id="what-types-of-vehicles-were-involved-in-crashes">What types of vehicles were involved in crashes?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crashes_by_type, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_rev</span>(<span class="fu">fct_inorder</span>(Type_code)), <span class="at">y =</span> Crashes)) <span class="sc">+</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vehicle type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-incidents-by-vehicle-type" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-incidents-by-vehicle-type-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-incidents-by-vehicle-type-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-incidents-by-vehicle-type-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Incidents by vehicle type
</figcaption>
</figure>
</div>
</div>
</div>
<p>Without knowing more about how common different types of vehicles are in NYC, we can’t make strong inferences from this data; i.e., the prevalence of sedans, SUVs, and station wagons in the crash data likely reflects the prevalence of these vehicles on the road, period. If we wanted to explore whether certain vehicle types are disproportionately likely to be involved in crashes, we’d need to know not just how many of each vehicle type are present in the city, but also how many hours each vehicle type is in motion on average (since, for example, buses and box trucks probably spend more of their time driving than private passenger vehicles, even if there are more of the latter).</p>
</section>
<section id="what-contributing-factors-were-involved-in-crashes" class="level4">
<h4 class="anchored" data-anchor-id="what-contributing-factors-were-involved-in-crashes">What contributing factors were involved in crashes?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>crashes_by_factor <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Contributing_factor <span class="sc">!=</span> <span class="st">"Unspecified"</span>) <span class="sc">%&gt;%</span> <span class="co"># Ignore missing data</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_rev</span>(<span class="fu">fct_inorder</span>(Contributing_factor)), <span class="at">y =</span> Crashes)) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Contributing factor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-incidents-by-factor" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-incidents-by-factor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-incidents-by-factor-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-incidents-by-factor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Incidents by contributing factor
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here, we can draw more inferences from the data alone. Distracted driving seems to be a clear issue, as well as following too closely and failing to yield.</p>
</section>
<section id="how-many-vehicles-were-involved-per-crash" class="level4">
<h4 class="anchored" data-anchor-id="how-many-vehicles-were-involved-per-crash">How many vehicles were involved per crash?</h4>
<p>We can also examine how many vehicles were involved per crash, and plot the distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(vehicle_dat, Collision_id, <span class="at">name =</span> <span class="st">"Vehicles"</span>) <span class="sc">%&gt;%</span> <span class="co"># Count vehicles per collision</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Vehicles, <span class="at">name =</span> <span class="st">"Crashes"</span>) <span class="sc">%&gt;%</span> <span class="co"># Count collisions for each number of vehicles</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> Crashes<span class="sc">/</span><span class="fu">sum</span>(Crashes),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Label =</span> <span class="fu">paste0</span>(scales<span class="sc">::</span><span class="fu">percent</span>(Proportion),<span class="st">"</span><span class="sc">\n</span><span class="st">(n="</span>,Crashes,<span class="st">")"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Vehicles, <span class="at">y =</span> Crashes, <span class="at">label =</span> Label)) <span class="sc">+</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of vehicles involved"</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_y =</span> <span class="dv">3000</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-incidents-by-vehicles-involved" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-incidents-by-vehicles-involved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-incidents-by-vehicles-involved-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-incidents-by-vehicles-involved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Incidents by number of vehicles involved
</figcaption>
</figure>
</div>
</div>
</div>
<p>Perhaps unsurprisingly, the majority of crashes involved two vehicles; crashes involving three or more vehicles were relatively rare (&lt;10% of crashes).</p>
</section>
</section>
</section>
<section id="mapping" class="level2">
<h2 class="anchored" data-anchor-id="mapping">Mapping</h2>
<p>Finally, let’s map the data! We’ll begin by filtering out crashes missing location data, or with location (0,0):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>crash_map_dat <span class="ot">&lt;-</span> <span class="fu">filter</span>(crash_dat, Latitude <span class="sc">!=</span> <span class="dv">0</span>, Longitude <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The easiest way to check for outliers is simply to plot the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crash_map_dat, <span class="fu">aes</span>(<span class="at">x=</span>Longitude, <span class="at">y=</span>Latitude)) <span class="sc">+</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="co"># Small/transparent to handle overplotting</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-basic-map" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-basic-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-basic-map-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-basic-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Crash locations
</figcaption>
</figure>
</div>
</div>
</div>
<p>The projection is a little wonky, but we can see the map taking shape. There are enough data points in our data set to make individual streets!</p>
<section id="individual-crashes" class="level3">
<h3 class="anchored" data-anchor-id="individual-crashes">Individual crashes</h3>
<p>We can improve our map by incorporating actual map data for New York City. Fortunately, most of the heavy lifting has already been done for us by the <code>nycgeo</code> package! Among other things, this package can split the geography up according to different types of administrative boundaries, from boroughs all the way down to invidual census tracts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load NYC map data (https://nycgeo.mattherman.info/index.html)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>map_dat <span class="ot">&lt;-</span> <span class="fu">nyc_boundaries</span>(<span class="at">geography =</span> <span class="st">"tract"</span>) <span class="co"># Split into census tracts</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add simple features (sf) to our data set</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>crash_map_dat <span class="ot">&lt;-</span> crash_map_dat <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitude"</span>,<span class="st">"Latitude"</span>), </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs=</span><span class="dv">4326</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now overlay individual crashes as points on a map of census tracts:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> crash_map_dat) <span class="sc">+</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> map_dat, <span class="at">mapping =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">size =</span> <span class="fl">0.025</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>old-style crs object detected; please recreate object with a recent sf::st_crs()</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-advanced-map" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-advanced-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-advanced-map-1.png" class="img-fluid figure-img" style="width:150.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-advanced-map-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Crash locations
</figcaption>
</figure>
</div>
</div>
</div>
<p>Plotting crashes as individual points is useful for identifying where crashes occurred, but things get muddled by the sheer number of data points, especially where the data get dense (e.g., basically all of Manhattan).</p>
</section>
<section id="choropleth-map" class="level3">
<h3 class="anchored" data-anchor-id="choropleth-map">Choropleth map</h3>
<p>The solution is to aggregate the data by dividing the map into subsections and coloring them based on the number of crashes. We’ll define the subsections based on census tracts, thus making a choropleth map!</p>
<p>We’ll also need a way to identify which tract each crash occurred in, since our data only includes the lat/lon of the crash. Fortunately, <code>nyc_point_poly()</code> will do just this!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>crash_map_dat_tract <span class="ot">&lt;-</span> <span class="fu">nyc_point_poly</span>(crash_map_dat, <span class="st">"tract"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>old-style crs object detected; please recreate object with a recent sf::st_crs()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Trasnsforming points to EPSG 2263</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>old-style crs object detected; please recreate object with a recent sf::st_crs()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>crashes_by_tract <span class="ot">&lt;-</span> crash_map_dat_tract <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tract_id, <span class="at">name =</span> <span class="st">"Crashes"</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(crashes_by_tract, <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-crashes-per-tract" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-crashes-per-tract-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Crashes per tract
</figcaption>
<div aria-describedby="tbl-crashes-per-tract-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["tract_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Crashes"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"009300","2":"498"},{"1":"001900","2":"493"},{"1":"001800","2":"477"},{"1":"038302","2":"477"},{"1":"003300","2":"411"},{"1":"006300","2":"383"},{"1":"030600","2":"374"},{"1":"014300","2":"351"},{"1":"019900","2":"345"},{"1":"043500","2":"330"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
<!-- Can we predict number of crashes by tract characteristics (e.g., income/poverty)? -->
<p>Now we’ll join this with our map data and plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(map_dat,crashes_by_tract) <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Crashes)) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>() <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.815</span>)) <span class="co"># Position legend in blank area of plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(tract_id)`
old-style crs object detected; please recreate object with a recent
sf::st_crs()</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-choropleth" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-choropleth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-choropleth-1.png" class="img-fluid figure-img" style="width:150.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-choropleth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Crashes by census tract
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can use a similar approach to plot other variables by tract. Let’s look at the total number of injuries reported per tract:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>injuries_by_tract <span class="ot">&lt;-</span> crash_map_dat_tract <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tract_id) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Injuries =</span><span class="fu">sum</span>(Number_of_persons_injured)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(injuries_by_tract, <span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["tract_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Injuries"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"000100","2":"92"},{"1":"000200","2":"95"},{"1":"000201","2":"5"},{"1":"000202","2":"28"},{"1":"000300","2":"18"},{"1":"000301","2":"4"},{"1":"000400","2":"29"},{"1":"000501","2":"1"},{"1":"000502","2":"3"},{"1":"000600","2":"34"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(map_dat,injuries_by_tract) <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Injuries)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>() <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.815</span>)) <span class="co"># Position legend in blank area of plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(tract_id)`
old-style crs object detected; please recreate object with a recent
sf::st_crs()</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-choropleth-Injuries" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-choropleth-Injuries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-choropleth-Injuries-1.png" class="img-fluid figure-img" style="width:150.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-choropleth-Injuries-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Injuries by census tract
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="heatmap" class="level3">
<h3 class="anchored" data-anchor-id="heatmap">Heatmap</h3>
<p>For comparison, we can also make a heatmap. Same basic idea as the choropleth map (i.e., colors represent number of crashes per area), but the areas are formed by dividing the geography up into regular polygons, rather than using real-world divisions like census tracts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> map_dat, <span class="at">mapping =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">data =</span> <span class="fu">filter</span>(crash_dat, Latitude <span class="sc">!=</span> <span class="dv">0</span>, Longitude <span class="sc">!=</span> <span class="dv">0</span>), </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">x=</span>Longitude,<span class="at">y=</span>Latitude),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">binwidth=</span><span class="fl">0.005</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.815</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>old-style crs object detected; please recreate object with a recent sf::st_crs()</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-heatmap" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-heatmap-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Crashes by location (heatmap)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Personally, I like the choropleth map better; it’s easier to see how the distribution of crashes maps onto the actual geography of the city.</p>
</section>
<section id="crashes-by-street-and-tract" class="level3">
<h3 class="anchored" data-anchor-id="crashes-by-street-and-tract">Crashes by street and tract</h3>
<p>In both of our choropleth maps, we can see a couple of tracts with high rates of crashes relative to the surrounding areas (e.g., the long tract between Brooklyn and Queens that seems to correspond to Flushing Meadows Corona Park). I’m guessing that some of these high rates of crashes may be due to freeways and expressways running through the tracts in question. Conveniently, the data set includes the names of the street on which each crash occurred! Let’s look at the street with the most crashes in the top 20 tracts by crashes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>crash_map_dat_tract <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tract_id, On_street_name, <span class="at">name =</span> <span class="st">"Crashes"</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(On_street_name) <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tract_id <span class="sc">%in%</span> <span class="fu">head</span>(crashes_by_tract<span class="sc">$</span>tract_id,<span class="dv">20</span>)) <span class="sc">%&gt;%</span> <span class="co"># Top 20 tracts</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> Crashes, <span class="at">n=</span><span class="dv">1</span>, <span class="at">by =</span> tract_id) <span class="co"># Street w/ most crashes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-street-crashes-per-tract" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-street-crashes-per-tract-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Street with most crashes per tract
</figcaption>
<div aria-describedby="tbl-street-crashes-per-tract-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["tract_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["On_street_name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Crashes"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"038302","2":"GRAND CENTRAL PKWY","3":"194"},{"1":"030600","2":"BELT PARKWAY","3":"128"},{"1":"009300","2":"BRUCKNER BOULEVARD","3":"126"},{"1":"001900","2":"BRUCKNER BOULEVARD","3":"98"},{"1":"043500","2":"MAJOR DEEGAN EXPRESSWAY","3":"79"},{"1":"001800","2":"GOWANUS EXPY (BQE)","3":"74"},{"1":"110400","2":"LINDEN BOULEVARD","3":"72"},{"1":"006300","2":"MAJOR DEEGAN EXPRESSWAY","3":"70"},{"1":"024700","2":"FULTON STREET","3":"52"},{"1":"044900","2":"BROOKLYN QUEENS EXPRESSWAY","3":"52"},{"1":"014300","2":"CENTRAL PARK WEST","3":"50"},{"1":"021800","2":"CROSS BRONX EXPY","3":"42"},{"1":"028300","2":"MAJOR DEEGAN EXPRESSWAY","3":"41"},{"1":"003300","2":"CANAL STREET","3":"38"},{"1":"002100","2":"BROOKLYN QUEENS EXPRESSWAY","3":"31"},{"1":"019900","2":"LONG ISLAND EXPRESSWAY","3":"31"},{"1":"004300","2":"ATLANTIC AVENUE","3":"30"},{"1":"012500","2":"GRAND CENTRAL PKWY","3":"26"},{"1":"000700","2":"BROOKLYN QUEENS EXPRESSWAY","3":"25"},{"1":"011900","2":"3 AVENUE","3":"14"},{"1":"011900","2":"4 AVENUE","3":"14"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>As expected, in the tracts with the most crashes, the street with the most crashes tends to be a parkway or expressway.</p>
<p>While we’re at it, let’s look at the top 50 streets for crashes citywide. We’ll use the full data set (<code>crash_dat</code>) to include cases where the street was recorded but the latitude/longitude were not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>crash_dat <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(On_street_name) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">On_street_name =</span> <span class="fu">str_to_title</span>(On_street_name)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(On_street_name, <span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">name =</span> <span class="st">"Crashes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n=</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-street-crashes" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-street-crashes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Street with most crashes citywide
</figcaption>
<div aria-describedby="tbl-street-crashes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["On_street_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Crashes"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Belt Parkway","2":"1348"},{"1":"Brooklyn Queens Expressway","2":"905"},{"1":"Broadway","2":"841"},{"1":"Long Island Expressway","2":"835"},{"1":"Atlantic Avenue","2":"717"},{"1":"Fdr Drive","2":"694"},{"1":"Grand Central Pkwy","2":"658"},{"1":"Cross Island Parkway","2":"555"},{"1":"3 Avenue","2":"547"},{"1":"Major Deegan Expressway","2":"525"},{"1":"Linden Boulevard","2":"486"},{"1":"Northern Boulevard","2":"433"},{"1":"Henry Hudson Parkway","2":"429"},{"1":"Van Wyck Expwy","2":"418"},{"1":"Staten Island Expressway","2":"408"},{"1":"Bruckner Boulevard","2":"386"},{"1":"Flatbush Avenue","2":"384"},{"1":"Cross Bronx Expy","2":"351"},{"1":"Jamaica Avenue","2":"340"},{"1":"Bruckner Expressway","2":"333"},{"1":"Queens Boulevard","2":"331"},{"1":"Eastern Parkway","2":"313"},{"1":"2 Avenue","2":"310"},{"1":"Bronx River Parkway","2":"310"},{"1":"Verrazano Bridge Upper","2":"310"},{"1":"Bushwick Avenue","2":"309"},{"1":"Bedford Avenue","2":"303"},{"1":"Fulton Street","2":"303"},{"1":"Hylan Boulevard","2":"301"},{"1":"Triborough Bridge","2":"300"},{"1":"Nostrand Avenue","2":"296"},{"1":"4 Avenue","2":"290"},{"1":"Myrtle Avenue","2":"266"},{"1":"Utica Avenue","2":"266"},{"1":"Jerome Avenue","2":"250"},{"1":"Jackie Robinson Pkwy","2":"242"},{"1":"5 Avenue","2":"239"},{"1":"Amsterdam Avenue","2":"238"},{"1":"Pennsylvania Avenue","2":"229"},{"1":"Grand Concourse","2":"225"},{"1":"Kings Highway","2":"224"},{"1":"Ocean Parkway","2":"224"},{"1":"Liberty Avenue","2":"222"},{"1":"Grand Central Parkway","2":"221"},{"1":"Metropolitan Avenue","2":"216"},{"1":"Park Avenue","2":"216"},{"1":"Webster Avenue","2":"214"},{"1":"Rockaway Boulevard","2":"210"},{"1":"8 Avenue","2":"209"},{"1":"1 Avenue","2":"206"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
</section>
<section id="future-directions" class="level1">
<h1>Future Directions</h1>
<p>What we’ve done so far barely scratches the surface of the data set; I went for breadth over depth in this post. Here’s a handful of ways I’d like to explore the data further (these may be featured in future blog posts):</p>
<ul>
<li>Incorporate data from previous years and examine whether number of crashes/injuries/fatalities changes with start/end of daylight savings time.</li>
<li>Explore whether specific vehicle types or contributing factors predict greater likelihood of injuries/fatalities.</li>
<li>Combine with other data sets
<ul>
<li>Road hours by vehicle type: are certain vehicle types disproportionately likely to be involved in crashes?</li>
<li>Census tract data: do tract characteristics (e.g., income, employment) predict frequency of crashes?</li>
</ul></li>
<li>Interactivity! Use <code>leaflet</code> and <code>shiny</code> to build an interactive map of crash data, allowing users to zoom/scroll the map and filter by date range, vehicle type, contributing factor, and more.</li>
</ul>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>In general, <code>vroom::vroom()</code> is much <a href="https://vroom.r-lib.org/articles/benchmarks.html">faster</a> than <code>read.csv()</code>, but here we’re also limited by connection speed; it took a little over a minute to read the data in with this approach.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There are a number of approaches for dealing with very large (and larger-than-memory) data sets, which I hope to cover in future posts.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Obligatory reference to <a href="https://en.wikipedia.org/wiki/Unknown_Pleasures#Artwork_and_packaging">that one Joy Division album cover</a>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>